{"paragraphs":[{"text":"import org.apache.spark.sql.{DataFrame, SparkSession}\nimport org.apache.log4j.Logger\nimport org.apache.log4j.Level\nimport java.io.File","user":"anonymous","dateUpdated":"2018-02-01T09:35:21+0000","config":{"colWidth":12,"editorMode":"ace/mode/scala","results":{},"enabled":true,"editorSetting":{"language":"scala"}},"settings":{"params":{},"forms":{}},"results":{"code":"SUCCESS","msg":[{"type":"TEXT","data":"import org.apache.spark.sql.{DataFrame, SparkSession}\nimport org.apache.log4j.Logger\nimport org.apache.log4j.Level\nimport java.io.File\n"}]},"apps":[],"jobName":"paragraph_1516973556073_75313316","id":"20180125-142223_645739549","dateCreated":"2018-01-26T13:32:36+0000","dateStarted":"2018-02-01T09:35:21+0000","dateFinished":"2018-02-01T09:35:21+0000","status":"FINISHED","progressUpdateIntervalMs":500,"focus":true,"$$hashKey":"object:5589"},{"text":"Logger.getLogger(\"org\").setLevel(Level.ERROR)\nLogger.getLogger(\"akka\").setLevel(Level.ERROR)\n\nval spark = SparkSession\n  .builder()\n  .appName(\"Spark SQL basic example\")\n  .config(\"spark.master\", \"local\")\n  .getOrCreate()\n\n\ndef getListOfFile(dir: String): List[String] = {\n  val d = new File(dir)\n  if (d.exists && d.isDirectory) {\n    var res = d.listFiles.filter(_.isFile).toList\n    res = res.filter(_.getName.endsWith(\".json\"))\n    res.map(_.toString)\n  } else {\n    List[String]()\n  }\n}\n\ndef getJson(x: String): Unit = {\n  spark.read.json(x)\n}\n\ndef exportToCsv(x: DataFrame, exportDirectory: String, n: Int): Unit = {\n  x.repartition(1)\n    .write\n    .option(\"header\", \"true\")\n    .csv(exportDirectory + n + \".csv\")\n}\n\n\n","user":"anonymous","dateUpdated":"2018-02-01T09:35:44+0000","config":{"colWidth":12,"editorMode":"ace/mode/scala","results":{},"enabled":true,"editorSetting":{"language":"scala"}},"settings":{"params":{},"forms":{}},"results":{"code":"SUCCESS","msg":[{"type":"TEXT","data":"spark: org.apache.spark.sql.SparkSession = org.apache.spark.sql.SparkSession@53974d3c\ngetListOfFile: (dir: String)List[String]\ngetJson: (x: String)Unit\nexportToCsv: (x: org.apache.spark.sql.DataFrame, exportDirectory: String, n: Int)Unit\n"}]},"apps":[],"jobName":"paragraph_1516973556075_76082814","id":"20180125-142301_2036030206","dateCreated":"2018-01-26T13:32:36+0000","dateStarted":"2018-02-01T09:35:44+0000","dateFinished":"2018-02-01T09:35:45+0000","status":"FINISHED","progressUpdateIntervalMs":500,"$$hashKey":"object:5590"},{"text":"//val df = spark.read.csv(\"/home/pythonadmuser/Desktop/local_cadvisu/csv/mobilitygraph/mobilitygraph-2018-01-16-03-40-23_usermobilitygraph.csv\")\n//println(df.count)","user":"anonymous","dateUpdated":"2018-02-01T09:36:38+0000","config":{"colWidth":12,"enabled":true,"results":{},"editorSetting":{"language":"scala"},"editorMode":"ace/mode/scala"},"settings":{"params":{},"forms":{}},"results":{"code":"SUCCESS","msg":[]},"apps":[],"jobName":"paragraph_1517424110014_307827226","id":"20180131-184150_693397003","dateCreated":"2018-01-31T18:41:50+0000","dateStarted":"2018-02-01T09:36:38+0000","dateFinished":"2018-02-01T09:36:38+0000","status":"FINISHED","progressUpdateIntervalMs":500,"$$hashKey":"object:5591"},{"text":"df.show","user":"anonymous","dateUpdated":"2018-01-31T18:43:49+0000","config":{"colWidth":12,"enabled":true,"results":{},"editorSetting":{"language":"scala"},"editorMode":"ace/mode/scala"},"settings":{"params":{},"forms":{}},"results":{"code":"SUCCESS","msg":[{"type":"TEXT","data":"+-----------+--------------------+--------------------+--------+----------+---------+-------------+------------+--------------------+----------+--------------------+--------------------+\n|        _c0|                 _c1|                 _c2|     _c3|       _c4|      _c5|          _c6|         _c7|                 _c8|       _c9|                _c10|                _c11|\n+-----------+--------------------+--------------------+--------+----------+---------+-------------+------------+--------------------+----------+--------------------+--------------------+\n|postal_code|        end_sequence|              id_fav|latitude| longitude|nb_points|num_days_seen|  place_type|      start_sequence|time_spent|   formatted_address|              userId|\n|      75001|2018-01-06T16:26:...|                null|48.86232|   2.34422|        2|            2|    detected|2018-01-03T18:17:...|    295.35|Allée Jules Super...|58980b7be4b090ae6...|\n|       null|2018-01-13T10:18:...|                null|10.34862| 107.08225|        8|            6|    detected|2017-12-11T07:26:...|   1466.78|Hẻm 82 Trương Côn...|5898451fe4b06c895...|\n|      38570|2018-01-15T19:12:...|                null|45.36767|   5.97807|        6|            5|    detected|2018-01-09T21:04:...|   1242.08|Route du Bouchet,...|5981c035e4b018f2e...|\n|      95240|2017-12-15T19:41:...|                null|48.96632|    2.2082|        4|            4|    detected|2017-12-12T16:47:...|    499.15|86-92 Route d'Arg...|5a2845dfe4b06fd61...|\n|      59500|2017-12-21T22:57:...|                null|50.36091|   3.08945|        3|            2|    detected|2017-12-18T14:15:...|    917.21|235 Rue Constant ...|54c93b71e4b0f4e0f...|\n|      13400|2018-01-13T22:23:...|                null| 43.2939|   5.59131|        3|            3|    detected|2017-12-17T15:32:...|    365.75|60 Chemin des Bon...|5a285b13e4b06fd61...|\n|      95150|2017-12-29T18:42:...|                null| 49.0213|   2.23676|        2|            2|    detected|2017-12-27T00:45:...|   2662.63|5 Rue des Pareux,...|5a28f5d0e4b0bb409...|\n|      66530|2018-01-07T14:16:...|                null|42.75588|   2.95777|       18|           13|    detected|2017-12-22T19:11:...|   9429.72|22 Rue André Chén...|58f49511e4b02cd22...|\n|      91430|2018-01-15T12:35:...|                null|48.73366|   2.20844|       14|           12|    detected|2017-12-11T11:51:...|   4261.19|8 Chemin des Sabl...|5a28ed58e4b02e808...|\n|      95100|2018-01-14T17:52:...|fa54f846-cfc7-422...|48.94989|   2.24193|       10|            9|userFavorite|2017-12-13T19:03:...|   1956.19|20 Rue Martinet, ...|5a22ca81e4b02d5ad...|\n|      75008|2018-01-02T23:45:...|                null| 48.8807|   2.31819|        3|            3|    detected|2017-12-11T20:24:...|   1801.27|35 Rue de Constan...|59760679e4b0ac034...|\n|      93270|2018-01-15T23:53:...|8e62c6f2-d4a6-4d7...| 48.9486|   2.51798|        7|            7|userFavorite|2017-12-10T21:05:...|    4705.9|2 Allée Manouchia...|5a22de7ce4b04fc86...|\n|      67000|2017-12-30T11:37:...|                null|48.58659|   7.77981|        2|            2|    detected|2017-12-28T22:38:...|   1461.62|6 Rue Bautain, 67...|56e9a004e4b0601d5...|\n|       null|2018-01-07T15:11:...|                null|-16.7268|-151.45968|        2|            2|    detected|2018-01-04T21:50:...|    2880.0|Unnamed Road, Fre...|56e9e457e4b05ef54...|\n|      54000|2018-01-12T13:11:...|                null|48.69426|   6.16592|        5|            5|    detected|2017-12-15T08:30:...|    749.07|44 D400, 54000 Na...|56773c4be4b02f55d...|\n|      75012|2018-01-15T18:42:...|                null| 48.8311|   2.38776|       28|           23|    detected|2017-12-11T08:58:...|  11613.68|16 Terrasse de Ch...|58cd2944e4b0a4738...|\n|      92300|2017-12-22T16:36:...|                null| 48.8917|   2.28542|        6|            5|    detected|2017-12-11T09:44:...|   3633.44|73 Rue Anatole Fr...|5a298603e4b02e808...|\n|      78150|2018-01-16T01:33:...|                null|48.82643|   2.12391|       26|           21|    detected|2017-12-17T15:45:...|  15786.49|4 Square Vivaldi,...|5a29944fe4b07ed53...|\n|      13004|2018-01-15T02:50:...|                null|43.30161|   5.40406|       29|           23|    detected|2017-12-11T20:13:...|  21342.12|43 Boulevard Bois...|5944cbc3e4b03cfa7...|\n+-----------+--------------------+--------------------+--------+----------+---------+-------------+------------+--------------------+----------+--------------------+--------------------+\nonly showing top 20 rows\n\n"}]},"apps":[],"jobName":"paragraph_1517424149151_-452943943","id":"20180131-184229_1705818298","dateCreated":"2018-01-31T18:42:29+0000","dateStarted":"2018-01-31T18:43:49+0000","dateFinished":"2018-01-31T18:43:50+0000","status":"FINISHED","progressUpdateIntervalMs":500,"$$hashKey":"object:5592"},{"text":"//reading json df\nval jsonPath: String = \"/home/pythonadmuser/Desktop/local_cadvisu/json/mobilitygraph/mobilitygraph-2018-01-16-03-40-23_usermobilitygraph.json\"\nval csvPath: String = \"/home/pythonadmuser/Desktop/local_cadvisu/csv/mobilitygraph/\"\n","user":"anonymous","dateUpdated":"2018-01-31T18:13:53+0000","config":{"colWidth":12,"editorMode":"ace/mode/scala","results":{},"enabled":true,"editorSetting":{"language":"scala"}},"settings":{"params":{},"forms":{}},"results":{"code":"SUCCESS","msg":[{"type":"TEXT","data":"jsonPath: String = /home/pythonadmuser/Desktop/local_cadvisu/json/mobilitygraph/mobilitygraph-2018-01-16-03-40-23_usermobilitygraph.json\ncsvPath: String = /home/pythonadmuser/Desktop/local_cadvisu/csv/mobilitygraph/\n"}]},"apps":[],"jobName":"paragraph_1516973556075_76082814","id":"20180125-143046_1090039923","dateCreated":"2018-01-26T13:32:36+0000","dateStarted":"2018-01-31T18:13:53+0000","dateFinished":"2018-01-31T18:13:54+0000","status":"FINISHED","progressUpdateIntervalMs":500,"$$hashKey":"object:5593"},{"text":"val df = spark.read.json(jsonPath)\ndf.printSchema()","user":"anonymous","dateUpdated":"2018-01-31T18:13:59+0000","config":{"colWidth":12,"editorMode":"ace/mode/scala","results":{},"enabled":true,"editorSetting":{"language":"scala"}},"settings":{"params":{},"forms":{}},"results":{"code":"SUCCESS","msg":[{"type":"TEXT","data":"df: org.apache.spark.sql.DataFrame = [geometry: struct<coordinates: array<double>, type: string>, properties: struct<address: struct<address_components: array<struct<long_name:string,short_name:string,types:array<string>>>, formatted_address: string ... 3 more fields>, end_sequence: string ... 11 more fields> ... 1 more field]\nroot\n |-- geometry: struct (nullable = true)\n |    |-- coordinates: array (nullable = true)\n |    |    |-- element: double (containsNull = true)\n |    |-- type: string (nullable = true)\n |-- properties: struct (nullable = true)\n |    |-- address: struct (nullable = true)\n |    |    |-- address_components: array (nullable = true)\n |    |    |    |-- element: struct (containsNull = true)\n |    |    |    |    |-- long_name: string (nullable = true)\n |    |    |    |    |-- short_name: string (nullable = true)\n |    |    |    |    |-- types: array (nullable = true)\n |    |    |    |    |    |-- element: string (containsNull = true)\n |    |    |-- formatted_address: string (nullable = true)\n |    |    |-- geometry: struct (nullable = true)\n |    |    |    |-- bounds: struct (nullable = true)\n |    |    |    |    |-- northeast: struct (nullable = true)\n |    |    |    |    |    |-- lat: double (nullable = true)\n |    |    |    |    |    |-- lng: double (nullable = true)\n |    |    |    |    |-- southwest: struct (nullable = true)\n |    |    |    |    |    |-- lat: double (nullable = true)\n |    |    |    |    |    |-- lng: double (nullable = true)\n |    |    |    |-- location: struct (nullable = true)\n |    |    |    |    |-- lat: double (nullable = true)\n |    |    |    |    |-- lng: double (nullable = true)\n |    |    |    |-- location_type: string (nullable = true)\n |    |    |    |-- viewport: struct (nullable = true)\n |    |    |    |    |-- northeast: struct (nullable = true)\n |    |    |    |    |    |-- lat: double (nullable = true)\n |    |    |    |    |    |-- lng: double (nullable = true)\n |    |    |    |    |-- southwest: struct (nullable = true)\n |    |    |    |    |    |-- lat: double (nullable = true)\n |    |    |    |    |    |-- lng: double (nullable = true)\n |    |    |-- place_id: string (nullable = true)\n |    |    |-- types: array (nullable = true)\n |    |    |    |-- element: string (containsNull = true)\n |    |-- end_sequence: string (nullable = true)\n |    |-- id_fav: string (nullable = true)\n |    |-- job_step: string (nullable = true)\n |    |-- latitude: double (nullable = true)\n |    |-- longitude: double (nullable = true)\n |    |-- nb_points: long (nullable = true)\n |    |-- num_days_seen: long (nullable = true)\n |    |-- place_type: string (nullable = true)\n |    |-- sequenceId_final: long (nullable = true)\n |    |-- start_sequence: string (nullable = true)\n |    |-- time_spent: double (nullable = true)\n |    |-- userId: string (nullable = true)\n |-- type: string (nullable = true)\n\n"}]},"apps":[],"jobName":"paragraph_1516973556079_74543818","id":"20180125-144822_642464951","dateCreated":"2018-01-26T13:32:36+0000","dateStarted":"2018-01-31T18:13:59+0000","dateFinished":"2018-01-31T18:14:21+0000","status":"FINISHED","progressUpdateIntervalMs":500,"$$hashKey":"object:5594"},{"text":"","user":"anonymous","dateUpdated":"2018-01-31T16:52:03+0000","config":{"colWidth":12,"enabled":true,"results":{},"editorSetting":{"language":"scala"},"editorMode":"ace/mode/scala"},"settings":{"params":{},"forms":{}},"apps":[],"jobName":"paragraph_1517405192431_-1177036586","id":"20180131-132632_683974672","dateCreated":"2018-01-31T13:26:32+0000","status":"FINISHED","errorMessage":"","progressUpdateIntervalMs":500,"$$hashKey":"object:5595"},{"text":"","user":"anonymous","dateUpdated":"2018-01-31T16:52:04+0000","config":{"colWidth":12,"enabled":true,"results":{},"editorSetting":{"language":"scala"},"editorMode":"ace/mode/scala"},"settings":{"params":{},"forms":{}},"apps":[],"jobName":"paragraph_1517405702283_1802394310","id":"20180131-133502_660881975","dateCreated":"2018-01-31T13:35:02+0000","dateStarted":"2018-01-31T13:37:15+0000","dateFinished":"2018-01-31T13:37:15+0000","status":"FINISHED","errorMessage":"","progressUpdateIntervalMs":500,"$$hashKey":"object:5596"},{"text":"","user":"anonymous","dateUpdated":"2018-01-31T16:49:26+0000","config":{"colWidth":12,"enabled":true,"results":{},"editorSetting":{"language":"scala"},"editorMode":"ace/mode/scala"},"settings":{"params":{},"forms":{}},"apps":[],"jobName":"paragraph_1517411805475_1941792119","id":"20180131-151645_1162737271","dateCreated":"2018-01-31T15:16:45+0000","dateStarted":"2018-01-31T15:43:54+0000","dateFinished":"2018-01-31T15:43:55+0000","status":"FINISHED","errorMessage":"","progressUpdateIntervalMs":500,"$$hashKey":"object:5597"},{"text":"def get_postal_code(col:String): String = {\n    val regexpr : String = \"postal_code\"\n    val hasReg : Boolean = col.contains(regexpr)\n\n    hasReg match {\n        case true => {\n            val i = col.indexOf(regexpr)\n            val res = col.substring(i-19, i-14)\n            assert(res.length() == 5 )\n            if (res forall Character.isDigit){\n                res\n            } else \"\"\n            \n        }\n        case false => \"\"\n    }\n}\n\nval get_postal_codeUdf = udf(get_postal_code _)\n","user":"anonymous","dateUpdated":"2018-01-31T18:23:21+0000","config":{"colWidth":12,"enabled":true,"results":{},"editorSetting":{"language":"scala"},"editorMode":"ace/mode/scala"},"settings":{"params":{},"forms":{}},"results":{"code":"SUCCESS","msg":[{"type":"TEXT","data":"get_postal_code: (col: String)String\nget_postal_codeUdf: org.apache.spark.sql.expressions.UserDefinedFunction = UserDefinedFunction(<function1>,StringType,Some(List(StringType)))\n"}]},"apps":[],"jobName":"paragraph_1517414776264_-1337580931","id":"20180131-160616_1874952723","dateCreated":"2018-01-31T16:06:16+0000","dateStarted":"2018-01-31T18:23:21+0000","dateFinished":"2018-01-31T18:23:21+0000","status":"FINISHED","progressUpdateIntervalMs":500,"$$hashKey":"object:5598"},{"text":"\n","user":"anonymous","dateUpdated":"2018-01-31T17:19:17+0000","config":{"colWidth":12,"enabled":true,"results":{},"editorSetting":{"language":"scala"},"editorMode":"ace/mode/scala"},"settings":{"params":{},"forms":{}},"apps":[],"jobName":"paragraph_1517415137050_-575689453","id":"20180131-161217_19724332","dateCreated":"2018-01-31T16:12:17+0000","dateStarted":"2018-01-31T17:09:28+0000","dateFinished":"2018-01-31T17:09:29+0000","status":"ERROR","errorMessage":"","progressUpdateIntervalMs":500,"$$hashKey":"object:5599"},{"text":"import org.apache.spark.sql.functions._\n","user":"anonymous","dateUpdated":"2018-01-31T18:23:24+0000","config":{"colWidth":12,"enabled":true,"results":{},"editorSetting":{"language":"scala"},"editorMode":"ace/mode/scala"},"settings":{"params":{},"forms":{}},"results":{"code":"SUCCESS","msg":[{"type":"TEXT","data":"import org.apache.spark.sql.functions._\n"}]},"apps":[],"jobName":"paragraph_1516976027473_-1093465187","id":"20180126-141347_264766178","dateCreated":"2018-01-26T14:13:47+0000","dateStarted":"2018-01-31T18:23:24+0000","dateFinished":"2018-01-31T18:23:24+0000","status":"FINISHED","progressUpdateIntervalMs":500,"$$hashKey":"object:5600"},{"text":"val df1 = df.select(\"properties.end_sequence\",\n\"properties.id_fav\",\n\"properties.latitude\", \"properties.longitude\", \n\"properties.nb_points\", \"properties.num_days_seen\", \n\"properties.place_type\", \"properties.start_sequence\", \"properties.time_spent\",\n\"properties.address.formatted_address\",\n\"properties.userId\",\n\"properties.address.address_components\")\n\n\n\nval df2 = df1.map { case (address_components) => (address_components.mkString(\", \")) }\n\n\n\nval df3 = df1.withColumn(\"id1\", monotonically_increasing_id())\n\nval df4 = df2.withColumn(\"id2\", monotonically_increasing_id())\n\n\nval df5 = df4.withColumn(\"postal_code\", get_postal_codeUdf(df4(\"value\")))\n\n","user":"anonymous","dateUpdated":"2018-01-31T18:23:31+0000","config":{"colWidth":12,"enabled":true,"results":{},"editorSetting":{"language":"scala"},"editorMode":"ace/mode/scala"},"settings":{"params":{},"forms":{}},"results":{"code":"SUCCESS","msg":[{"type":"TEXT","data":"df1: org.apache.spark.sql.DataFrame = [end_sequence: string, id_fav: string ... 10 more fields]\ndf2: org.apache.spark.sql.Dataset[String] = [value: string]\ndf3: org.apache.spark.sql.DataFrame = [end_sequence: string, id_fav: string ... 11 more fields]\ndf4: org.apache.spark.sql.DataFrame = [value: string, id2: bigint]\ndf5: org.apache.spark.sql.DataFrame = [value: string, id2: bigint ... 1 more field]\n"}]},"apps":[],"jobName":"paragraph_1516975010213_117287052","id":"20180126-135650_1309783400","dateCreated":"2018-01-26T13:56:50+0000","dateStarted":"2018-01-31T18:23:31+0000","dateFinished":"2018-01-31T18:23:32+0000","status":"FINISHED","progressUpdateIntervalMs":500,"$$hashKey":"object:5601"},{"text":"df3.show","user":"anonymous","dateUpdated":"2018-01-31T18:20:55+0000","config":{"colWidth":12,"enabled":true,"results":{},"editorSetting":{"language":"scala"},"editorMode":"ace/mode/scala"},"settings":{"params":{},"forms":{}},"results":{"code":"SUCCESS","msg":[{"type":"TEXT","data":"+--------------------+------+--------+---------+---------+-------------+----------+--------------------+----------+--------------------+--------------------+--------------------+---+\n|        end_sequence|id_fav|latitude|longitude|nb_points|num_days_seen|place_type|      start_sequence|time_spent|   formatted_address|              userId|  address_components|id1|\n+--------------------+------+--------+---------+---------+-------------+----------+--------------------+----------+--------------------+--------------------+--------------------+---+\n|2018-01-15T08:44:...|  null|43.45769|  6.79469|       23|           23|  detected|2017-12-10T21:13:...|  20133.68|1205 Avenue des G...|589805d9e4b090ae6...|[[1205,1205,Wrapp...|  0|\n|2018-01-15T18:11:...|  null|43.44283|  6.71546|       24|           21|  detected|2017-12-11T09:19:...|  11216.29|429 Rue Albert Ei...|589805d9e4b090ae6...|[[429,429,Wrapped...|  1|\n|2018-01-11T20:38:...|  null|43.42406|   6.7695|        3|            3|  detected|2017-12-17T15:23:...|    415.78|145 Avenue Victor...|589805d9e4b090ae6...|[[145,145,Wrapped...|  2|\n|2018-01-13T18:43:...|  null|43.39459|  6.71628|        6|            4|  detected|2017-12-22T19:18:...|    1225.0|416 Avenue Châtea...|589805d9e4b090ae6...|[[416,416,Wrapped...|  3|\n|2017-12-28T10:35:...|  null|47.33479|  5.03695|        6|            5|  detected|2017-12-23T18:12:...|   4123.55|1-3 Rue Jehan de ...|589805d9e4b090ae6...|[[1-3,1-3,Wrapped...|  4|\n|2017-12-27T11:54:...|  null|47.32047|  5.03926|        2|            2|  detected|2017-12-24T11:08:...|    381.22|15-17 Rue Jules M...|589805d9e4b090ae6...|[[15-17,15-17,Wra...|  5|\n|2018-01-02T10:20:...|  null|45.42496|  6.63548|        5|            4|  detected|2017-12-28T14:40:...|    2928.7|Rue des Brigues, ...|589805d9e4b090ae6...|[[Rue des Brigues...|  6|\n|2017-12-29T09:02:...|  null|48.74155|  2.73395|       31|           19|  detected|2017-12-10T01:17:...|  19257.12|11 Boulevard Aris...|58980e3de4b0ea2ba...|[[11,11,WrappedAr...|  7|\n|2017-12-25T16:08:...|  null|48.74431|  2.77166|        4|            4|  detected|2017-12-10T19:12:...|    899.33|7-9 Rue Mozart, 7...|58980e3de4b0ea2ba...|[[7-9,7-9,Wrapped...|  8|\n|2017-12-29T16:13:...|  null|48.79289|  2.61501|       16|           15|  detected|2017-12-11T09:49:...|   4583.51|49 Rue Lazare Car...|58980e3de4b0ea2ba...|[[49,49,WrappedAr...|  9|\n|2017-12-19T23:09:...|  null|49.89181|  2.30656|        3|            3|  detected|2017-12-12T22:08:...|    405.92|23 Rue Alexandre ...|5898247ae4b090ae6...|[[23,23,WrappedAr...| 10|\n|2018-01-14T16:37:...|  null|49.15576|  2.95775|       12|           11|  detected|2017-12-15T15:17:...|  12066.69|20 Rue Beauxis La...|5898247ae4b090ae6...|[[20,20,WrappedAr...| 11|\n|2018-01-15T13:10:...|  null| 49.8984|   2.3028|       21|           16|  detected|2017-12-10T16:00:...|  15722.15|5 Place Aristide ...|5898247ae4b090ae6...|[[5,5,WrappedArra...| 12|\n|2018-01-13T19:25:...|  null|49.08676|  2.74708|        8|            7|  detected|2017-12-23T19:35:...|    3678.5|23 Avenue des Tem...|5898247ae4b090ae6...|[[23,23,WrappedAr...| 13|\n|2018-01-01T11:05:...|  null|49.04204|  2.80339|        2|            2|  detected|2017-12-25T17:11:...|    787.23|14 Rue du Pommier...|5898247ae4b090ae6...|[[14,14,WrappedAr...| 14|\n|2017-12-29T18:46:...|  null|45.67658| -1.01197|        5|            4|  detected|2017-12-26T18:37:...|    3797.7|15 Rue du Moulin ...|5898247ae4b090ae6...|[[15,15,WrappedAr...| 15|\n|2018-01-06T18:09:...|  null|49.23629|   2.8892|        2|            2|  detected|2018-01-01T14:37:...|     469.6|11 Rue Gaston d'O...|5898247ae4b090ae6...|[[11,11,WrappedAr...| 16|\n|2018-01-15T09:18:...|  null|48.82452|  2.24641|       31|           27|  detected|2017-12-10T16:50:...|  23233.26|D1, 92100 Boulogn...|58980b7be4b090ae6...|[[D1,D1,WrappedAr...| 17|\n|2018-01-12T19:13:...|  null|48.84869|  2.37348|       21|           17|  detected|2017-12-11T17:37:...|   6450.82|64 Avenue Ledru-R...|58980b7be4b090ae6...|[[64,64,WrappedAr...| 18|\n|2018-01-10T19:40:...|  null|48.86984|   2.3057|        4|            3|  detected|2017-12-12T17:30:...|    442.07|41 Rue Marbeuf, 7...|58980b7be4b090ae6...|[[41,41,WrappedAr...| 19|\n+--------------------+------+--------+---------+---------+-------------+----------+--------------------+----------+--------------------+--------------------+--------------------+---+\nonly showing top 20 rows\n\n"}]},"apps":[],"jobName":"paragraph_1517420296120_-1680441766","id":"20180131-173816_1533019769","dateCreated":"2018-01-31T17:38:16+0000","dateStarted":"2018-01-31T18:20:55+0000","dateFinished":"2018-01-31T18:20:56+0000","status":"FINISHED","progressUpdateIntervalMs":500,"$$hashKey":"object:5602"},{"text":"df5.show","user":"anonymous","dateUpdated":"2018-01-31T18:23:39+0000","config":{"colWidth":12,"enabled":true,"results":{},"editorSetting":{"language":"scala"},"editorMode":"ace/mode/scala"},"settings":{"params":{},"forms":{}},"results":{"code":"SUCCESS","msg":[{"type":"TEXT","data":"+--------------------+---+-----------+\n|               value|id2|postal_code|\n+--------------------+---+-----------+\n|2018-01-15T08:44:...|  0|      83700|\n|2018-01-15T18:11:...|  1|      83600|\n|2018-01-11T20:38:...|  2|      83700|\n|2018-01-13T18:43:...|  3|      83370|\n|2017-12-28T10:35:...|  4|      21000|\n|2017-12-27T11:54:...|  5|      21000|\n|2018-01-02T10:20:...|  6|      73120|\n|2017-12-29T09:02:...|  7|      77220|\n|2017-12-25T16:08:...|  8|      77220|\n|2017-12-29T16:13:...|  9|      77340|\n|2017-12-19T23:09:...| 10|      80000|\n|2018-01-14T16:37:...| 11|      60620|\n|2018-01-15T13:10:...| 12|      80000|\n|2018-01-13T19:25:...| 13|      60330|\n|2018-01-01T11:05:...| 14|      77165|\n|2017-12-29T18:46:...| 15|      17200|\n|2018-01-06T18:09:...| 16|      60800|\n|2018-01-15T09:18:...| 17|      92100|\n|2018-01-12T19:13:...| 18|      75012|\n|2018-01-10T19:40:...| 19|      75008|\n+--------------------+---+-----------+\nonly showing top 20 rows\n\n"}]},"apps":[],"jobName":"paragraph_1517420240268_862904995","id":"20180131-173720_1755462253","dateCreated":"2018-01-31T17:37:20+0000","dateStarted":"2018-01-31T18:23:39+0000","dateFinished":"2018-01-31T18:23:40+0000","status":"FINISHED","progressUpdateIntervalMs":500,"$$hashKey":"object:5603"},{"text":"val df6 = df5.join(df3, $\"id1\" === $\"id2\",\"inner\")\nval df7 = df6.drop(df6.col(\"id1\")).drop(df6.col(\"id2\")).drop(df6.col(\"value\")).drop(df6.col(\"value\")).drop(df6.col(\"address_components\"))\ndf7.show\n","user":"anonymous","dateUpdated":"2018-01-31T18:23:46+0000","config":{"colWidth":12,"enabled":true,"results":{},"editorSetting":{"language":"scala"},"editorMode":"ace/mode/scala"},"settings":{"params":{},"forms":{}},"results":{"code":"SUCCESS","msg":[{"type":"TEXT","data":"df6: org.apache.spark.sql.DataFrame = [value: string, id2: bigint ... 14 more fields]\ndf7: org.apache.spark.sql.DataFrame = [postal_code: string, end_sequence: string ... 10 more fields]\n+-----------+--------------------+--------------------+--------+----------+---------+-------------+------------+--------------------+----------+--------------------+--------------------+\n|postal_code|        end_sequence|              id_fav|latitude| longitude|nb_points|num_days_seen|  place_type|      start_sequence|time_spent|   formatted_address|              userId|\n+-----------+--------------------+--------------------+--------+----------+---------+-------------+------------+--------------------+----------+--------------------+--------------------+\n|      75001|2018-01-06T16:26:...|                null|48.86232|   2.34422|        2|            2|    detected|2018-01-03T18:17:...|    295.35|Allée Jules Super...|58980b7be4b090ae6...|\n|           |2018-01-13T10:18:...|                null|10.34862| 107.08225|        8|            6|    detected|2017-12-11T07:26:...|   1466.78|Hẻm 82 Trương Côn...|5898451fe4b06c895...|\n|      38570|2018-01-15T19:12:...|                null|45.36767|   5.97807|        6|            5|    detected|2018-01-09T21:04:...|   1242.08|Route du Bouchet,...|5981c035e4b018f2e...|\n|      95240|2017-12-15T19:41:...|                null|48.96632|    2.2082|        4|            4|    detected|2017-12-12T16:47:...|    499.15|86-92 Route d'Arg...|5a2845dfe4b06fd61...|\n|      59500|2017-12-21T22:57:...|                null|50.36091|   3.08945|        3|            2|    detected|2017-12-18T14:15:...|    917.21|235 Rue Constant ...|54c93b71e4b0f4e0f...|\n|      13400|2018-01-13T22:23:...|                null| 43.2939|   5.59131|        3|            3|    detected|2017-12-17T15:32:...|    365.75|60 Chemin des Bon...|5a285b13e4b06fd61...|\n|      95150|2017-12-29T18:42:...|                null| 49.0213|   2.23676|        2|            2|    detected|2017-12-27T00:45:...|   2662.63|5 Rue des Pareux,...|5a28f5d0e4b0bb409...|\n|      66530|2018-01-07T14:16:...|                null|42.75588|   2.95777|       18|           13|    detected|2017-12-22T19:11:...|   9429.72|22 Rue André Chén...|58f49511e4b02cd22...|\n|      91430|2018-01-15T12:35:...|                null|48.73366|   2.20844|       14|           12|    detected|2017-12-11T11:51:...|   4261.19|8 Chemin des Sabl...|5a28ed58e4b02e808...|\n|      95100|2018-01-14T17:52:...|fa54f846-cfc7-422...|48.94989|   2.24193|       10|            9|userFavorite|2017-12-13T19:03:...|   1956.19|20 Rue Martinet, ...|5a22ca81e4b02d5ad...|\n|      75008|2018-01-02T23:45:...|                null| 48.8807|   2.31819|        3|            3|    detected|2017-12-11T20:24:...|   1801.27|35 Rue de Constan...|59760679e4b0ac034...|\n|      93270|2018-01-15T23:53:...|8e62c6f2-d4a6-4d7...| 48.9486|   2.51798|        7|            7|userFavorite|2017-12-10T21:05:...|    4705.9|2 Allée Manouchia...|5a22de7ce4b04fc86...|\n|      67000|2017-12-30T11:37:...|                null|48.58659|   7.77981|        2|            2|    detected|2017-12-28T22:38:...|   1461.62|6 Rue Bautain, 67...|56e9a004e4b0601d5...|\n|           |2018-01-07T15:11:...|                null|-16.7268|-151.45968|        2|            2|    detected|2018-01-04T21:50:...|    2880.0|Unnamed Road, Fre...|56e9e457e4b05ef54...|\n|      54000|2018-01-12T13:11:...|                null|48.69426|   6.16592|        5|            5|    detected|2017-12-15T08:30:...|    749.07|44 D400, 54000 Na...|56773c4be4b02f55d...|\n|      75012|2018-01-15T18:42:...|                null| 48.8311|   2.38776|       28|           23|    detected|2017-12-11T08:58:...|  11613.68|16 Terrasse de Ch...|58cd2944e4b0a4738...|\n|      92300|2017-12-22T16:36:...|                null| 48.8917|   2.28542|        6|            5|    detected|2017-12-11T09:44:...|   3633.44|73 Rue Anatole Fr...|5a298603e4b02e808...|\n|      78150|2018-01-16T01:33:...|                null|48.82643|   2.12391|       26|           21|    detected|2017-12-17T15:45:...|  15786.49|4 Square Vivaldi,...|5a29944fe4b07ed53...|\n|      13004|2018-01-15T02:50:...|                null|43.30161|   5.40406|       29|           23|    detected|2017-12-11T20:13:...|  21342.12|43 Boulevard Bois...|5944cbc3e4b03cfa7...|\n|      33270|2018-01-14T15:01:...|                null|44.82702|  -0.53135|       26|           21|    detected|2017-12-10T19:41:...|  19733.62|23 Rue des Steame...|54e0d8a0e4b02e8a8...|\n+-----------+--------------------+--------------------+--------+----------+---------+-------------+------------+--------------------+----------+--------------------+--------------------+\nonly showing top 20 rows\n\n"}]},"apps":[],"jobName":"paragraph_1517420014442_-1398955524","id":"20180131-173334_117207635","dateCreated":"2018-01-31T17:33:34+0000","dateStarted":"2018-01-31T18:23:46+0000","dateFinished":"2018-01-31T18:24:23+0000","status":"FINISHED","progressUpdateIntervalMs":500,"$$hashKey":"object:5604"},{"text":"df7.count","user":"anonymous","dateUpdated":"2018-01-31T18:26:29+0000","config":{"colWidth":12,"editorMode":"ace/mode/scala","results":{},"enabled":true,"editorSetting":{"language":"scala"}},"settings":{"params":{},"forms":{}},"results":{"code":"SUCCESS","msg":[{"type":"TEXT","data":"res34: Long = 1610332\n"}]},"apps":[],"jobName":"paragraph_1516973556081_84547290","id":"20180126-101625_1488602698","dateCreated":"2018-01-26T13:32:36+0000","dateStarted":"2018-01-31T18:26:29+0000","dateFinished":"2018-01-31T18:27:00+0000","status":"FINISHED","progressUpdateIntervalMs":500,"$$hashKey":"object:5605"},{"user":"anonymous","config":{"colWidth":12,"enabled":true,"results":{},"editorSetting":{"language":"scala"},"editorMode":"ace/mode/scala"},"settings":{"params":{},"forms":{}},"apps":[],"jobName":"paragraph_1516983307638_1956150051","id":"20180126-161507_1223871856","dateCreated":"2018-01-26T16:15:07+0000","status":"READY","errorMessage":"","progressUpdateIntervalMs":500,"$$hashKey":"object:5606"},{"text":"","dateUpdated":"2018-01-26T15:58:43+0000","config":{"colWidth":12,"editorMode":"ace/mode/scala","results":{"0":{"graph":{"mode":"table","height":95.1,"optionOpen":false}}},"enabled":true,"editorSetting":{"language":"scala"}},"settings":{"params":{},"forms":{}},"apps":[],"jobName":"paragraph_1516973556082_85701536","id":"20180126-102515_1308531367","dateCreated":"2018-01-26T13:32:36+0000","status":"READY","errorMessage":"","progressUpdateIntervalMs":500,"$$hashKey":"object:5607"},{"text":"","dateUpdated":"2018-01-26T15:58:57+0000","config":{"colWidth":12,"editorMode":"ace/mode/scala","results":{},"enabled":true,"editorSetting":{"language":"scala"}},"settings":{"params":{},"forms":{}},"apps":[],"jobName":"paragraph_1516973556082_85701536","id":"20180126-102152_885056139","dateCreated":"2018-01-26T13:32:36+0000","status":"READY","errorMessage":"","progressUpdateIntervalMs":500,"$$hashKey":"object:5608"},{"text":"","user":"anonymous","dateUpdated":"2018-01-31T17:44:11+0000","config":{"colWidth":12,"editorMode":"ace/mode/scala","results":{},"enabled":true,"editorSetting":{"language":"scala"}},"settings":{"params":{},"forms":{}},"results":{"code":"SUCCESS","msg":[{"type":"TEXT","data":"res111: String = /home/pythonadmuser/Desktop/local_cadvisu/csv/mobilitygraph/\n"}]},"apps":[],"jobName":"paragraph_1516973556082_85701536","id":"20180126-130746_1222327867","dateCreated":"2018-01-26T13:32:36+0000","dateStarted":"2018-01-31T17:44:00+0000","dateFinished":"2018-01-31T17:44:00+0000","status":"FINISHED","progressUpdateIntervalMs":500,"$$hashKey":"object:5609"},{"text":"exportToCsv(df7, csvPath+\"mobilitygraph/\", 0)","user":"anonymous","dateUpdated":"2018-01-31T18:24:31+0000","config":{"colWidth":12,"editorMode":"ace/mode/scala","results":{},"enabled":true,"editorSetting":{"language":"scala"}},"settings":{"params":{},"forms":{}},"results":{"code":"SUCCESS","msg":[]},"apps":[],"jobName":"paragraph_1516973556083_85316787","id":"20180126-125523_1271527735","dateCreated":"2018-01-26T13:32:36+0000","dateStarted":"2018-01-31T18:24:31+0000","dateFinished":"2018-01-31T18:25:12+0000","status":"FINISHED","progressUpdateIntervalMs":500,"$$hashKey":"object:5610"},{"text":"","dateUpdated":"2018-01-26T15:59:33+0000","config":{"tableHide":false,"editorSetting":{"language":"scala"},"colWidth":12,"editorMode":"ace/mode/scala","results":{},"enabled":true},"settings":{"params":{},"forms":{}},"apps":[],"jobName":"paragraph_1516973556087_83777792","id":"20180125-145207_722329235","dateCreated":"2018-01-26T13:32:36+0000","status":"READY","errorMessage":"","progressUpdateIntervalMs":500,"$$hashKey":"object:5611"},{"dateUpdated":"2018-01-26T13:32:36+0000","config":{"colWidth":12,"enabled":true,"results":{},"editorSetting":{"language":"scala"},"editorMode":"ace/mode/scala"},"settings":{"params":{},"forms":{}},"apps":[],"jobName":"paragraph_1516973556087_83777792","id":"20180125-145722_300453410","dateCreated":"2018-01-26T13:32:36+0000","status":"READY","errorMessage":"","progressUpdateIntervalMs":500,"$$hashKey":"object:5612"}],"name":"JsonToCsvUser_Mobility","id":"2D7KA5ANC","angularObjects":{"2D5R26EDC:shared_process":[],"2D49QQE1Z:shared_process":[],"2D4AXB7EJ:shared_process":[],"2D57383AK:shared_process":[],"2D5Q1RJ4S:shared_process":[],"2D58DZSCU:shared_process":[],"2D419R7MY:shared_process":[],"2D5FNWST2:shared_process":[],"2D5TJPR66:shared_process":[],"2D5FDCGT3:shared_process":[],"2D5VCE5FZ:shared_process":[],"2D39NPP6R:shared_process":[],"2D5H94SSD:shared_process":[],"2D6DB69DE:shared_process":[],"2D6GU6UMQ:shared_process":[],"2D61RHCTA:shared_process":[],"2D42RXKJA:shared_process":[],"2D3W4SNNJ:shared_process":[],"2D6GHKSWC:shared_process":[]},"config":{"looknfeel":"default","personalizedMode":"false"},"info":{}}