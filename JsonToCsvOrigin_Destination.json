{"paragraphs":[{"text":"import org.apache.spark.sql.{DataFrame, SparkSession}\nimport org.apache.log4j.Logger\nimport org.apache.log4j.Level\nimport java.io.File","user":"anonymous","dateUpdated":"2018-02-01T09:31:28+0000","config":{"colWidth":12,"enabled":true,"results":{},"editorSetting":{"language":"scala"},"editorMode":"ace/mode/scala"},"settings":{"params":{},"forms":{}},"results":{"code":"SUCCESS","msg":[{"type":"TEXT","data":"import org.apache.spark.sql.{DataFrame, SparkSession}\nimport org.apache.log4j.Logger\nimport org.apache.log4j.Level\nimport java.io.File\n"}]},"apps":[],"jobName":"paragraph_1516890143169_1526055859","id":"20180125-142223_645739549","dateCreated":"2018-01-25T14:22:23+0000","dateStarted":"2018-02-01T09:31:28+0000","dateFinished":"2018-02-01T09:31:44+0000","status":"FINISHED","progressUpdateIntervalMs":500,"focus":true,"$$hashKey":"object:282"},{"text":"Logger.getLogger(\"akka\").setLevel(Level.ERROR)\nLogger.getLogger(\"org\").setLevel(Level.ERROR)\n\nval spark = SparkSession\n  .builder()\n  .appName(\"Spark SQL basic example\")\n  .config(\"spark.master\", \"local\")\n  .getOrCreate()\n\n\ndef getListOfFile(dir: String): List[String] = {\n  val d = new File(dir)\n  if (d.exists && d.isDirectory) {\n    var res = d.listFiles.filter(_.isFile).toList\n    res = res.filter(_.getName.endsWith(\".json\"))\n    res.map(_.toString)\n  } else {\n    List[String]()\n  }\n}\n\ndef getJson(x: String): Unit = {\n  spark.read.json(x)\n}\n\ndef exportToCsv(x: DataFrame, exportDirectory: String, n: Int): Unit = {\n  x.repartition(1)\n    .write\n    .option(\"header\", \"true\")\n    .csv(exportDirectory + n + \".csv\")\n}\n\n\n","user":"anonymous","dateUpdated":"2018-02-01T09:31:46+0000","config":{"colWidth":12,"enabled":true,"results":{},"editorSetting":{"language":"scala"},"editorMode":"ace/mode/scala"},"settings":{"params":{},"forms":{}},"results":{"code":"SUCCESS","msg":[{"type":"TEXT","data":"spark: org.apache.spark.sql.SparkSession = org.apache.spark.sql.SparkSession@53974d3c\ngetListOfFile: (dir: String)List[String]\ngetJson: (x: String)Unit\nexportToCsv: (x: org.apache.spark.sql.DataFrame, exportDirectory: String, n: Int)Unit\n"}]},"apps":[],"jobName":"paragraph_1516890181811_969586356","id":"20180125-142301_2036030206","dateCreated":"2018-01-25T14:23:01+0000","dateStarted":"2018-02-01T09:31:46+0000","dateFinished":"2018-02-01T09:31:55+0000","status":"FINISHED","progressUpdateIntervalMs":500,"$$hashKey":"object:283"},{"text":"//reading json df\nval jsonPath: String = \"/home/pythonadmuser/Desktop/local_cadvisu/json/mobilitygraph/\"\nval csvPath: String = \"/home/pythonadmuser/Desktop/local_cadvisu/csv/\"\n","user":"anonymous","dateUpdated":"2018-02-01T09:32:02+0000","config":{"colWidth":12,"enabled":true,"results":{},"editorSetting":{"language":"scala"},"editorMode":"ace/mode/scala"},"settings":{"params":{},"forms":{}},"results":{"code":"SUCCESS","msg":[{"type":"TEXT","data":"jsonPath: String = /home/pythonadmuser/Desktop/local_cadvisu/json/mobilitygraph/\ncsvPath: String = /home/pythonadmuser/Desktop/local_cadvisu/csv/\n"}]},"apps":[],"jobName":"paragraph_1516890646467_724944063","id":"20180125-143046_1090039923","dateCreated":"2018-01-25T14:30:46+0000","dateStarted":"2018-02-01T09:32:03+0000","dateFinished":"2018-02-01T09:32:03+0000","status":"FINISHED","progressUpdateIntervalMs":500,"$$hashKey":"object:284"},{"text":"val df = spark.read.json(jsonPath+\"mobilitygraph-2018-01-16-03-40-23_origin_destination.json\")\nprintln(df.count)\ndf.printSchema()","user":"anonymous","dateUpdated":"2018-02-01T09:32:17+0000","config":{"colWidth":12,"enabled":true,"results":{},"editorSetting":{"language":"scala"},"editorMode":"ace/mode/scala"},"settings":{"params":{},"forms":{}},"results":{"code":"SUCCESS","msg":[{"type":"TEXT","data":"df: org.apache.spark.sql.DataFrame = [coordinates_destination: struct<lat: double, lon: double>, coordinates_origin: struct<lat: double, lon: double> ... 14 more fields]\n11964771\nroot\n |-- coordinates_destination: struct (nullable = true)\n |    |-- lat: double (nullable = true)\n |    |-- lon: double (nullable = true)\n |-- coordinates_origin: struct (nullable = true)\n |    |-- lat: double (nullable = true)\n |    |-- lon: double (nullable = true)\n |-- day_of_week: long (nullable = true)\n |-- destination: long (nullable = true)\n |-- destination_latitude: double (nullable = true)\n |-- destination_longitude: double (nullable = true)\n |-- destination_ts: string (nullable = true)\n |-- duration: double (nullable = true)\n |-- is_weekday: boolean (nullable = true)\n |-- job_step: string (nullable = true)\n |-- latitude: double (nullable = true)\n |-- longitude: double (nullable = true)\n |-- origin: long (nullable = true)\n |-- origin_ts: string (nullable = true)\n |-- time_of_day_as_geo_point: struct (nullable = true)\n |    |-- lat: long (nullable = true)\n |    |-- lon: double (nullable = true)\n |-- userId: string (nullable = true)\n\n"}]},"apps":[],"jobName":"paragraph_1516891702003_-1272198298","id":"20180125-144822_642464951","dateCreated":"2018-01-25T14:48:22+0000","dateStarted":"2018-02-01T09:32:17+0000","dateFinished":"2018-02-01T09:33:18+0000","status":"FINISHED","progressUpdateIntervalMs":500,"$$hashKey":"object:285"},{"text":"val df2 = df.withColumnRenamed(\"longitude\", \"origin_longitude\").withColumnRenamed(\"latitude\", \"origin_latitude\").\ndrop(\"coordinates_destination\", \"coordinates_origin\", \"job_step\")\n\ndf2.printSchema()","user":"anonymous","dateUpdated":"2018-01-31T10:59:14+0000","config":{"colWidth":12,"enabled":true,"results":{},"editorSetting":{"language":"scala"},"editorMode":"ace/mode/scala"},"settings":{"params":{},"forms":{}},"results":{"code":"SUCCESS","msg":[{"type":"TEXT","data":"df2: org.apache.spark.sql.DataFrame = [day_of_week: bigint, destination: bigint ... 11 more fields]\nroot\n |-- day_of_week: long (nullable = true)\n |-- destination: long (nullable = true)\n |-- destination_latitude: double (nullable = true)\n |-- destination_longitude: double (nullable = true)\n |-- destination_ts: string (nullable = true)\n |-- duration: double (nullable = true)\n |-- is_weekday: boolean (nullable = true)\n |-- origin_latitude: double (nullable = true)\n |-- origin_longitude: double (nullable = true)\n |-- origin: long (nullable = true)\n |-- origin_ts: string (nullable = true)\n |-- time_of_day_as_geo_point: struct (nullable = true)\n |    |-- lat: long (nullable = true)\n |    |-- lon: double (nullable = true)\n |-- userId: string (nullable = true)\n\n"}]},"apps":[],"jobName":"paragraph_1516896567385_1566694378","id":"20180125-160927_1292416762","dateCreated":"2018-01-25T16:09:27+0000","dateStarted":"2018-01-31T10:59:14+0000","dateFinished":"2018-01-31T10:59:14+0000","status":"FINISHED","progressUpdateIntervalMs":500,"$$hashKey":"object:286"},{"text":"val df3 = df2.select(\"time_of_day_as_geo_point.lat\", \"time_of_day_as_geo_point.lon\").withColumnRenamed(\"lon\", \"time_of_day_as_geo_point_lon\")\n.withColumnRenamed(\"lat\", \"time_of_day_as_geo_point_lat\")\n\n\ndf3.show(2)","user":"anonymous","dateUpdated":"2018-01-31T11:00:17+0000","config":{"colWidth":12,"enabled":true,"results":{},"editorSetting":{"language":"scala"},"editorMode":"ace/mode/scala"},"settings":{"params":{},"forms":{}},"results":{"code":"SUCCESS","msg":[{"type":"TEXT","data":"df3: org.apache.spark.sql.DataFrame = [time_of_day_as_geo_point_lat: bigint, time_of_day_as_geo_point_lon: double]\n+----------------------------+----------------------------+\n|time_of_day_as_geo_point_lat|time_of_day_as_geo_point_lon|\n+----------------------------+----------------------------+\n|                           0|          -48.81666666666666|\n|                           0|          -22.04583333333335|\n+----------------------------+----------------------------+\nonly showing top 2 rows\n\n"}]},"apps":[],"jobName":"paragraph_1516960825018_-296067454","id":"20180126-100025_838880228","dateCreated":"2018-01-26T10:00:25+0000","dateStarted":"2018-01-31T11:00:17+0000","dateFinished":"2018-01-31T11:00:18+0000","status":"FINISHED","progressUpdateIntervalMs":500,"$$hashKey":"object:287"},{"text":"import org.apache.spark.sql.functions._\n\nval df4 = df2.withColumn(\"id1\", monotonically_increasing_id())\n\nval df5 = df3.withColumn(\"id2\", monotonically_increasing_id())\n\ndf4.show(2)","user":"anonymous","dateUpdated":"2018-01-31T11:00:31+0000","config":{"colWidth":12,"enabled":true,"results":{},"editorSetting":{"language":"scala"},"editorMode":"ace/mode/scala"},"settings":{"params":{},"forms":{}},"results":{"code":"SUCCESS","msg":[{"type":"TEXT","data":"import org.apache.spark.sql.functions._\ndf4: org.apache.spark.sql.DataFrame = [day_of_week: bigint, destination: bigint ... 12 more fields]\ndf5: org.apache.spark.sql.DataFrame = [time_of_day_as_geo_point_lat: bigint, time_of_day_as_geo_point_lon: double ... 1 more field]\n+-----------+-----------+--------------------+---------------------+--------------------+--------+----------+---------------+----------------+------+--------------------+------------------------+--------------------+---+\n|day_of_week|destination|destination_latitude|destination_longitude|      destination_ts|duration|is_weekday|origin_latitude|origin_longitude|origin|           origin_ts|time_of_day_as_geo_point|              userId|id1|\n+-----------+-----------+--------------------+---------------------+--------------------+--------+----------+---------------+----------------+------+--------------------+------------------------+--------------------+---+\n|          4|          0|            48.73177|              2.25724|2017-12-21T14:00:...|   316.0|      true|       48.73177|         2.25724|     0|2017-12-21T08:44:...|    [0,-48.8166666666...|54d0b3a0e4b09c46b...|  0|\n|          2|         80|            45.88776|              6.10037|2017-12-19T10:32:...|    0.75|      true|       45.88935|         6.09432|    12|2017-12-19T10:31:...|    [0,-22.0458333333...|555c2a8de4b0f98b4...|  1|\n+-----------+-----------+--------------------+---------------------+--------------------+--------+----------+---------------+----------------+------+--------------------+------------------------+--------------------+---+\nonly showing top 2 rows\n\n"}]},"apps":[],"jobName":"paragraph_1516961757482_-993654960","id":"20180126-101557_1155570130","dateCreated":"2018-01-26T10:15:57+0000","dateStarted":"2018-01-31T11:00:31+0000","dateFinished":"2018-01-31T11:00:32+0000","status":"FINISHED","progressUpdateIntervalMs":500,"$$hashKey":"object:288"},{"text":"val df6 = df4.join(df5, $\"id1\" === $\"id2\",\"inner\")\n\ndf6.show()\n","user":"anonymous","dateUpdated":"2018-01-31T11:00:41+0000","config":{"colWidth":12,"enabled":true,"results":{},"editorSetting":{"language":"scala"},"editorMode":"ace/mode/scala"},"settings":{"params":{},"forms":{}},"results":{"code":"SUCCESS","msg":[{"type":"TEXT","data":"df6: org.apache.spark.sql.DataFrame = [day_of_week: bigint, destination: bigint ... 15 more fields]\n+-----------+-----------+--------------------+---------------------+--------------------+--------+----------+---------------+----------------+------+--------------------+------------------------+--------------------+----+----------------------------+----------------------------+----+\n|day_of_week|destination|destination_latitude|destination_longitude|      destination_ts|duration|is_weekday|origin_latitude|origin_longitude|origin|           origin_ts|time_of_day_as_geo_point|              userId| id1|time_of_day_as_geo_point_lat|time_of_day_as_geo_point_lon| id2|\n+-----------+-----------+--------------------+---------------------+--------------------+--------+----------+---------------+----------------+------+--------------------+------------------------+--------------------+----+----------------------------+----------------------------+----+\n|          0|         12|            45.88929|              6.09433|2017-12-17T22:11:...|    0.63|     false|       45.88844|         6.09934|    80|2017-12-17T22:10:...|            [0,152.6125]|555c2a8de4b0f98b4...|  26|                           0|                    152.6125|  26|\n|          1|         12|            45.88935|              6.09432|2017-12-18T19:31:...|   32.67|      true|       46.07693|            6.15|     7|2017-12-18T18:58:...|    [0,104.7291666666...|555c2a8de4b0f98b4...|  29|                           0|          104.72916666666669|  29|\n|          0|          0|            48.99834|              2.19214|2017-12-17T17:27:...|  300.23|     false|        48.9984|         2.19231|     0|2017-12-17T12:27:...|    [0,6.787499999999...|559c3448e4b060cbe...| 474|                           0|           6.787499999999994| 474|\n|          2|          0|            48.01817|              -0.7701|2017-12-19T19:39:...|   105.0|      true|        48.0551|        -0.79306|    10|2017-12-19T17:54:...|    [0,88.70416666666...|5752ca63e4b0aefc4...| 964|                           0|           88.70416666666665| 964|\n|          2|          0|            45.55358|              5.88473|2018-01-09T17:53:...|   27.57|      true|       45.58086|          5.9087|    15|2018-01-09T17:25:...|    [0,81.35833333333...|574c2831e4b03199f...|1677|                           0|           81.35833333333329|1677|\n|          6|          0|            45.55362|              5.88476|2017-12-23T12:05:...|    65.3|     false|       45.55362|          5.8848|     0|2017-12-23T11:00:...|    [0,-14.9166666666...|574c2831e4b03199f...|1697|                           0|         -14.916666666666657|1697|\n|          3|          0|            48.63118|               2.3281|2018-01-03T19:20:...|   91.87|      true|       48.89076|         2.24327|    12|2018-01-03T17:48:...|    [0,87.08749999999...|578d2cfee4b040ce8...|1806|                           0|           87.08749999999998|1806|\n|          4|          2|            45.75431|              4.82534|2017-12-14T09:23:...|    15.0|      true|       46.76514|         4.49957|     1|2017-12-14T09:08:...|    [0,-42.9749999999...|56b387d0e4b08d44a...|1950|                           0|         -42.974999999999994|1950|\n|          3|          0|            48.75344|              2.28073|2017-12-20T11:58:...|   10.87|      true|       48.77969|         2.29721|     7|2017-12-20T11:47:...|    [0,-3.05833333333...|56053eede4b01ce7f...|2040|                           0|          -3.058333333333337|2040|\n|          3|          4|            48.87637|              2.31119|2017-12-27T14:14:...|    5.83|      true|       48.87017|         2.31099|    65|2017-12-27T14:09:...|    [0,32.27500000000...|55422e43e4b05b3cf...|2214|                           0|          32.275000000000006|2214|\n|          2|         16|            48.86827|              2.32534|2018-01-09T09:34:...|   16.35|      true|       48.88495|         2.32716|    -1|2018-01-09T09:17:...|    [0,-40.5833333333...|55492885e4b05b3cf...|2250|                           0|          -40.58333333333334|2250|\n|          5|         93|            48.89081|              2.33836|2017-12-15T10:40:...|  262.32|      true|       46.17243|        -1.12629|   245|2017-12-15T06:17:...|             [0,-85.575]|55e8c83ae4b0907db...|2453|                           0|                     -85.575|2453|\n|          1|         48|            48.87578|              2.55408|2017-12-11T19:06:...|   130.0|      true|        48.8972|         2.39702|     7|2017-12-11T16:56:...|    [0,74.06666666666...|5603aa5ae4b0a3360...|2509|                           0|           74.06666666666669|2509|\n|          6|         -1|            48.88211|              2.61857|2018-01-06T05:16:...|   15.18|     false|       48.88124|         2.62315|    88|2018-01-06T05:01:...|    [0,-104.579166666...|563ba822e4b08f090...|2529|                           0|         -104.57916666666667|2529|\n|          2|         18|            48.51457|              2.26084|2018-01-02T17:57:...|    79.8|      true|       48.62815|          2.3347|    10|2018-01-02T16:37:...|    [0,69.30000000000...|57b54c4ae4b0c0fab...|2927|                           0|           69.30000000000001|2927|\n|          3|         29|            43.95873|              4.86829|2018-01-03T17:22:...|  181.22|      true|       43.95866|         4.86834|    29|2018-01-03T14:21:...|    [0,35.40000000000...|566ec9cbe4b02f55d...|3091|                           0|          35.400000000000006|3091|\n|          0|         38|            48.69046|              6.17633|2017-12-24T11:45:...|     0.0|     false|       48.68844|           6.172|    38|2017-12-24T11:45:...|    [0,-3.54999999999...|559ec0cfe4b04e697...|3506|                           0|          -3.549999999999983|3506|\n|          0|          0|            55.84702|             12.46331|2018-01-14T21:38:...|  257.43|     false|       55.69394|        12.56457|    41|2018-01-14T17:21:...|             [0,80.3125]|5784dce0e4b0e9487...|3764|                           0|                     80.3125|3764|\n|          5|        176|            42.43114|              1.92802|2017-12-29T13:08:...|   55.32|      true|       42.41482|         1.98081|     4|2017-12-29T12:12:...|    [0,3.175000000000...|554a660ae4b05b3cf...|4590|                           0|          3.1750000000000114|4590|\n|          3|          1|            48.91511|              2.19783|2017-12-20T08:39:...|    90.0|      true|       48.93731|          1.8403|     0|2017-12-20T07:09:...|    [0,-72.6583333333...|56eb9c5de4b09fe2b...|4823|                           0|          -72.65833333333333|4823|\n+-----------+-----------+--------------------+---------------------+--------------------+--------+----------+---------------+----------------+------+--------------------+------------------------+--------------------+----+----------------------------+----------------------------+----+\nonly showing top 20 rows\n\n"}]},"apps":[],"jobName":"paragraph_1516961839609_911511035","id":"20180126-101719_442442897","dateCreated":"2018-01-26T10:17:19+0000","dateStarted":"2018-01-31T11:00:41+0000","dateFinished":"2018-01-31T11:01:41+0000","status":"FINISHED","progressUpdateIntervalMs":500,"$$hashKey":"object:289"},{"text":"\nval df7 = df6.drop(df6.col(\"id1\")).drop(df6.col(\"id2\")).drop(df6.col(\"time_of_day_as_geo_point\"))\ndf7.show(1)\n","user":"anonymous","dateUpdated":"2018-01-31T11:01:50+0000","config":{"colWidth":12,"enabled":true,"results":{},"editorSetting":{"language":"scala"},"editorMode":"ace/mode/scala"},"settings":{"params":{},"forms":{}},"results":{"code":"SUCCESS","msg":[{"type":"TEXT","data":"df7: org.apache.spark.sql.DataFrame = [day_of_week: bigint, destination: bigint ... 12 more fields]\n+-----------+-----------+--------------------+---------------------+--------------------+--------+----------+---------------+----------------+------+--------------------+--------------------+----------------------------+----------------------------+\n|day_of_week|destination|destination_latitude|destination_longitude|      destination_ts|duration|is_weekday|origin_latitude|origin_longitude|origin|           origin_ts|              userId|time_of_day_as_geo_point_lat|time_of_day_as_geo_point_lon|\n+-----------+-----------+--------------------+---------------------+--------------------+--------+----------+---------------+----------------+------+--------------------+--------------------+----------------------------+----------------------------+\n|          0|         12|            45.88929|              6.09433|2017-12-17T22:11:...|    0.63|     false|       45.88844|         6.09934|    80|2017-12-17T22:10:...|555c2a8de4b0f98b4...|                           0|                    152.6125|\n+-----------+-----------+--------------------+---------------------+--------------------+--------+----------+---------------+----------------+------+--------------------+--------------------+----------------------------+----------------------------+\nonly showing top 1 row\n\n"}]},"apps":[],"jobName":"paragraph_1516962112774_-1651303033","id":"20180126-102152_885056139","dateCreated":"2018-01-26T10:21:52+0000","dateStarted":"2018-01-31T11:01:50+0000","dateFinished":"2018-01-31T11:02:48+0000","status":"FINISHED","progressUpdateIntervalMs":500,"$$hashKey":"object:290"},{"text":"def HaversineDistance(lat1:Double, lon1:Double, lat2:Double, lon2:Double) : Double = {\n    val AVERAGE_RADIUS_OF_EARTH_KM = 6371\n    \n    val latDistance = Math.toRadians(lat1 - lat2)\n    val lonDistance = Math.toRadians(lon1 - lon2)\n    \n    val sinLat = Math.sin(latDistance / 2)\n    val sinLon = Math.sin(lonDistance / 2)\n    \n    val a = sinLat * sinLat +\n      (Math.cos(Math.toRadians(lat1))\n        * Math.cos(Math.toRadians(lat2))\n        * sinLon * sinLon)\n    \n    val c = 2 * Math.atan2(Math.sqrt(a), Math.sqrt(1 - a))\n    \n    return (AVERAGE_RADIUS_OF_EARTH_KM * c)\n    }\n\nval HaversineDistanceUdf = udf(HaversineDistance _)\n","user":"anonymous","dateUpdated":"2018-01-31T11:03:17+0000","config":{"colWidth":12,"enabled":true,"results":{},"editorSetting":{"language":"scala"},"editorMode":"ace/mode/scala"},"settings":{"params":{},"forms":{}},"results":{"code":"SUCCESS","msg":[{"type":"TEXT","data":"HaversineDistance: (lat1: Double, lon1: Double, lat2: Double, lon2: Double)Double\nHaversineDistanceUdf: org.apache.spark.sql.expressions.UserDefinedFunction = UserDefinedFunction(<function4>,DoubleType,Some(List(DoubleType, DoubleType, DoubleType, DoubleType)))\n"}]},"apps":[],"jobName":"paragraph_1517242274712_1623465716","id":"20180129-161114_1404271972","dateCreated":"2018-01-29T16:11:14+0000","dateStarted":"2018-01-31T11:03:17+0000","dateFinished":"2018-01-31T11:03:17+0000","status":"FINISHED","progressUpdateIntervalMs":500,"$$hashKey":"object:291"},{"text":"val df8 = df7.withColumn(\"origin_destination_distance_km\", HaversineDistanceUdf(df7(\"destination_latitude\"), \ndf7(\"destination_longitude\"), df7(\"origin_latitude\"), df7(\"origin_longitude\")))\n\ndf8.show(5)\n","user":"anonymous","dateUpdated":"2018-01-31T11:03:21+0000","config":{"colWidth":12,"enabled":true,"results":{},"editorSetting":{"language":"scala"},"editorMode":"ace/mode/scala"},"settings":{"params":{},"forms":{}},"results":{"code":"SUCCESS","msg":[{"type":"TEXT","data":"df8: org.apache.spark.sql.DataFrame = [day_of_week: bigint, destination: bigint ... 13 more fields]\n+-----------+-----------+--------------------+---------------------+--------------------+--------+----------+---------------+----------------+------+--------------------+--------------------+----------------------------+----------------------------+------------------------------+\n|day_of_week|destination|destination_latitude|destination_longitude|      destination_ts|duration|is_weekday|origin_latitude|origin_longitude|origin|           origin_ts|              userId|time_of_day_as_geo_point_lat|time_of_day_as_geo_point_lon|origin_destination_distance_km|\n+-----------+-----------+--------------------+---------------------+--------------------+--------+----------+---------------+----------------+------+--------------------+--------------------+----------------------------+----------------------------+------------------------------+\n|          0|         12|            45.88929|              6.09433|2017-12-17T22:11:...|    0.63|     false|       45.88844|         6.09934|    80|2017-12-17T22:10:...|555c2a8de4b0f98b4...|                           0|                    152.6125|            0.3991141891649333|\n|          1|         12|            45.88935|              6.09432|2017-12-18T19:31:...|   32.67|      true|       46.07693|            6.15|     7|2017-12-18T18:58:...|555c2a8de4b0f98b4...|                           0|          104.72916666666669|             21.29700579234192|\n|          0|          0|            48.99834|              2.19214|2017-12-17T17:27:...|  300.23|     false|        48.9984|         2.19231|     0|2017-12-17T12:27:...|559c3448e4b060cbe...|                           0|           6.787499999999994|          0.014082635685167055|\n|          2|          0|            48.01817|              -0.7701|2017-12-19T19:39:...|   105.0|      true|        48.0551|        -0.79306|    10|2017-12-19T17:54:...|5752ca63e4b0aefc4...|                           0|           88.70416666666665|             4.447128129509092|\n|          2|          0|            45.55358|              5.88473|2018-01-09T17:53:...|   27.57|      true|       45.58086|          5.9087|    15|2018-01-09T17:25:...|574c2831e4b03199f...|                           0|           81.35833333333329|             3.561348234380937|\n+-----------+-----------+--------------------+---------------------+--------------------+--------+----------+---------------+----------------+------+--------------------+--------------------+----------------------------+----------------------------+------------------------------+\nonly showing top 5 rows\n\n"}]},"apps":[],"jobName":"paragraph_1517237473432_-1307431504","id":"20180129-145113_268602842","dateCreated":"2018-01-29T14:51:13+0000","dateStarted":"2018-01-31T11:03:21+0000","dateFinished":"2018-01-31T11:04:19+0000","status":"FINISHED","progressUpdateIntervalMs":500,"$$hashKey":"object:292"},{"text":"def exportToCsv(x: DataFrame, exportDirectory: String, n: Any): Unit = {\n  x.repartition(1)\n    .write\n    .option(\"header\", \"true\")\n    .csv(exportDirectory + n + \".csv\")\n}\n","user":"anonymous","dateUpdated":"2018-01-31T11:07:15+0000","config":{"colWidth":12,"enabled":true,"results":{},"editorSetting":{"language":"scala"},"editorMode":"ace/mode/scala"},"settings":{"params":{},"forms":{}},"results":{"code":"SUCCESS","msg":[{"type":"TEXT","data":"exportToCsv: (x: org.apache.spark.sql.DataFrame, exportDirectory: String, n: Any)Unit\n"}]},"apps":[],"jobName":"paragraph_1517396674714_1967888732","id":"20180131-110434_2101168182","dateCreated":"2018-01-31T11:04:34+0000","dateStarted":"2018-01-31T11:07:15+0000","dateFinished":"2018-01-31T11:07:15+0000","status":"FINISHED","progressUpdateIntervalMs":500,"$$hashKey":"object:293"},{"text":"exportToCsv(df8, csvPath+\"mobilitygraph/\", 1)","user":"anonymous","dateUpdated":"2018-01-31T11:11:46+0000","config":{"colWidth":12,"enabled":true,"results":{},"editorSetting":{"language":"scala"},"editorMode":"ace/mode/scala"},"settings":{"params":{},"forms":{}},"results":{"code":"SUCCESS","msg":[]},"apps":[],"jobName":"paragraph_1516971323468_953675918","id":"20180126-125523_1271527735","dateCreated":"2018-01-26T12:55:23+0000","dateStarted":"2018-01-31T11:07:45+0000","dateFinished":"2018-01-31T11:09:45+0000","status":"FINISHED","progressUpdateIntervalMs":500,"$$hashKey":"object:294"},{"user":"anonymous","config":{"colWidth":12,"enabled":true,"results":{},"editorSetting":{"language":"scala"},"editorMode":"ace/mode/scala"},"settings":{"params":{},"forms":{}},"apps":[],"jobName":"paragraph_1516892242041_725211676","id":"20180125-145722_300453410","dateCreated":"2018-01-25T14:57:22+0000","status":"READY","errorMessage":"","progressUpdateIntervalMs":500,"$$hashKey":"object:295"}],"name":"JsonToCsvOrigin_Destination","id":"2D4AQQ5GH","angularObjects":{"2D5R26EDC:shared_process":[],"2D49QQE1Z:shared_process":[],"2D4AXB7EJ:shared_process":[],"2D57383AK:shared_process":[],"2D5Q1RJ4S:shared_process":[],"2D58DZSCU:shared_process":[],"2D419R7MY:shared_process":[],"2D5FNWST2:shared_process":[],"2D5TJPR66:shared_process":[],"2D5FDCGT3:shared_process":[],"2D5VCE5FZ:shared_process":[],"2D39NPP6R:shared_process":[],"2D5H94SSD:shared_process":[],"2D6DB69DE:shared_process":[],"2D6GU6UMQ:shared_process":[],"2D61RHCTA:shared_process":[],"2D42RXKJA:shared_process":[],"2D3W4SNNJ:shared_process":[],"2D6GHKSWC:shared_process":[]},"config":{"looknfeel":"default","personalizedMode":"false"},"info":{}}